<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>
  
  <meta charset="utf-8" content="text/html; charset=ISO-8859-1" http-equiv="content-type">
  <title>detail</title>
  <link rel="stylesheet" href="/stylesheets/main.css">
  <link rel="stylesheet" href="/stylesheets/FlexiJsonEditor/jsoneditor.css"/> 

    <script type="text/javascript" src="/javascripts/json2.js"></script>
  <script type="text/javascript" src="/javascripts/jquery.min.js"></script>
  <script type="text/javascript" src="/javascripts/jquery.jsoneditor.js"></script>

<script type="text/javascript">

 $(function(){

        /////////////extract rule
        var extractRule = $.parseJSON($("#extract_rule").val());
        $('#extract_rule').change(function() {

        var  val = $('#extract_rule').val();

          if (val) {
              try { extractRule = JSON.parse(val); }
              catch (e) { alert('Error in parsing json. ' + e); }
          } else {
                  extractRule = {};
                }
            $('#extractEditor').jsonEditor(extractRule, { change: function(){
                $('#extract_rule').val(JSON.stringify(extractRule));
            }});        
        });
            $('#extractEditor').jsonEditor(extractRule, { change: function(){
                $('#extract_rule').val(JSON.stringify(extractRule));
            }});           

        /////////////cookie editor
        var cookie = $.parseJSON($("#cookie").val());

        $('#cookie').change(function() {

        var  val = $('#cookie').val();

          if (val) {
              try { cookie = JSON.parse(val); }
              catch (e) { alert('Error in parsing json. ' + e); }
          } else {
                  cookie = {};
                }
       
            $('#cookieEditor').jsonEditor(cookie, { change: function(){
                $('#cookie').val(JSON.stringify(cookie));
            }}); 
        });

        $('#cookieEditor').jsonEditor(cookie, { change: function(){
                $('#cookie').val(JSON.stringify(cookie));
        }});               

        /////////////drilling rule editor
        var drillRules = $.parseJSON($("#drill_rules").val());
        $('#drill_rules').change(function() {

        var  val = $('#drill_rules').val();

          if (val) {
              try { drillRules = JSON.parse(val); }
              catch (e) { alert('Error in parsing json. ' + e); }
          } else {
                  drillRules = {};
                }
            $('#ruleEditor').jsonEditor(drillRules, { change: function(){
                $('#drill_rules').val(JSON.stringify(drillRules));
            }});
        });

            $('#ruleEditor').jsonEditor(drillRules, { change: function(){
                $('#drill_rules').val(JSON.stringify(drillRules));
            }}); 

        /////////////drilling rule editor
        var drillRelation = $.parseJSON($("#drill_relation").val());
        $('#drill_relation').change(function() {

        var  val = $('#drill_relation').val();

          if (val) {
              try { drillRelation = JSON.parse(val); }
              catch (e) { alert('Error in parsing json. ' + e); }
          } else {
                  drillRelation = {};
                }
            $('#ruleRelationEditor').jsonEditor(drillRelation, { change: function(){
                $('#drill_relation').val(JSON.stringify(drillRelation));
            }});
        });

            $('#ruleRelationEditor').jsonEditor(drillRelation, { change: function(){
                $('#drill_relation').val(JSON.stringify(drillRelation));
            }});             

        /////////////script rule editor
        var  scriptJson = $.parseJSON($("#script").val());

        $('#script').change(function() {

          val = $('#script').val();

          if (val) {
              try { scriptJson = JSON.parse(val); }
              catch (e) { alert('Error in parsing json. ' + e); }
          } else {
                  scriptJson = {};
                }

            $('#scriptEditor').jsonEditor(scriptJson, { change: function(){
                $('#script').val(JSON.stringify(scriptJson));
            }});          
        });
            $('#scriptEditor').jsonEditor(scriptJson, { change: function(){
                $('#script').val(JSON.stringify(scriptJson));
            }});       

        /////////////navigation rule editor

        var naviRule = $.parseJSON($("#navigate_rule").val());

        $('#navigate_rule').change(function() {

          var val = $('#navigate_rule').val();

          if (val) {
              try { naviRule = JSON.parse(val); }
              catch (e) { alert('Error in parsing json. ' + e); }
          } else {
                  naviRule = {};
                }
            $('#naviEditor').jsonEditor(naviRule, { change: function(){
                $('#navigate_rule').val(JSON.stringify(naviRule));
            }});       
        }); 
            $('#naviEditor').jsonEditor(naviRule, { change: function(){
                $('#navigate_rule').val(JSON.stringify(naviRule));
            }});

        /////////////seed editor
        var seed = $.parseJSON($("#seed").val());
        $('#seed').change(function() {

        var  val = $('#seed').val();

          if (val) {
              try { seed = JSON.parse(val); }
              catch (e) { alert('Error in parsing json. ' + e); }
          } else {
                  seed = {};
                }
            $('#seedEditor').jsonEditor(seed, { change: function(){
                $('#navigate_rule').val(JSON.stringify(seed));
            }});        
        });
            $('#seedEditor').jsonEditor(seed, { change: function(){
                $('#navigate_rule').val(JSON.stringify(seed));
            }});           
/////////////////////////////////////////////////////        
        $('#form').submit(function(){
          $('#extract_rule').val(JSON.stringify(JSON.parse($("#extract_rule").val())));
          $('#cookie').val(JSON.stringify(JSON.parse($("#cookie").val())));
          $('#drill_rules').val(JSON.stringify(JSON.parse($("#drill_rules").val())));
          $('#scriptJson').val(JSON.stringify(JSON.parse($("#script").val()))); 
          $('#navigate_rule').val(JSON.stringify(JSON.parse($("#navigate_rule").val())));       
          $('#seed').val(JSON.stringify(JSON.parse($("#seed").val())));
        });      

  });
</script>

</head>

<body>

<h1>Edit <%= rule.domain %></h1>

<hr><a href="/rule">Return</a>

<form method="post" action="/rule/upsert" id="form">
  <table>
    <tbody> 
      <tr>
        <th>Domain</th>
        <td><input name="domain" id="domain" value="<%=rule.domain %>" size="30" type="text"></td>
      </tr>
     <tr>
        <th>url pattern</th>
        <td><input name="url_pattern" id="url_pattern" value="<%=rule.url_pattern %>" size="170" type="text"></td>
      </tr>      
      <tr>
        <th>Alias</th>
        <td><input name="alias" id="alias" value="<%=rule.alias %>" size="20" type="text"></td>
      </tr>
      <tr>
        <th>encoding</th>
        <td> <label><input name="encoding" value="UTF8" type="radio" <%if(rule.encoding === 'UTF8'){%> checked <%}%> >UTF8</label>&nbsp;&nbsp; <label><input name="encoding" value="GB2312" type="radio" <%if(rule.encoding === 'GB2312'){%> checked <%}%>>GB2312</label> 
        </td>          
      </tr>
      <tr>
        <th>type</th>
        <td> <label><input name="type" value="branch" type="radio" <%if(rule.type === 'branch'){%> checked <%}%> >branch</label>&nbsp;&nbsp; <label><input name="type" value="node" type="radio" <%if(rule.type === 'node'){%> checked <%}%>>node</label> 
        </td>         
      </tr>      
      <tr>
        <th>Extract content<br>
        </th>
        <td> <label><input name="save_page" value="true" type="radio" <%if(rule.save_page === 'true'){%> checked <%}%> >Yes</label>&nbsp;&nbsp; <label><input name="save_page" value="false" type="radio" <%if(rule.save_page === 'false'){%> checked <%}%>>No</label> 
        </td>         
      </tr>
      <tr>
        <th>format</th>
        <td> <label><input name="format" value="0" type="radio" <%if(rule.format === '0'){%> checked <%}%> >html</label>&nbsp;&nbsp; <label><input name="format" value="1" type="radio" <%if(rule.format === '1'){%> checked <%}%>>json</label>&nbsp;&nbsp; <label><input name="format" value="2" type="radio" <%if(rule.format === '2'){%> checked <%}%>>binary</label>  
        </td>         
      </tr>        
      <tr>
        <th>jshandle<br>
        </th>
        <td> <label><input name="jshandle" value="true" type="radio" <%if(rule.jshandle === 'true'){%> checked <%}%> >Yes</label>&nbsp;&nbsp; <label><input name="jshandle" value="false" type="radio" <%if(rule.jshandle === 'false'){%> checked <%}%>>No</label> 
        </td> 

      </tr>
      <tr>
        <th>Extract Rule</th>
        <td> 
        <div id="extractEditor" class="json-editor"></div>
         <div id="extractRuleJson">
          <textarea id="extract_rule" name="extract_rule" cols="130" rows="5"><%=rule.extract_rule%></textarea>
        </div>
      </tr>
      <tr>
        <th>cookie</th>
        <td> 
        <div id="cookieEditor" class="json-editor"></div>
         <div id="cookieJson">
          <textarea id="cookie" name="cookie" cols="130" rows="5"><%=rule.cookie%></textarea>
        </div>
      </tr>
      <tr>
        <th>Inject jquery</th>
        <td> <label><input name="inject_jquery" value="true" type="radio" <%if(rule.inject_jquery === 'true'){%> checked <%}%> >Yes</label>&nbsp;&nbsp; <label><input name="inject_jquery" value="false" type="radio" <%if(rule.inject_jquery === 'false'){%> checked <%}%>>No</label> 
        </td>                
      </tr>  
      <tr>
        <th>Load img</th>
        <td> <label><input name="load_img" value="true" type="radio" <%if(rule.load_img === 'true'){%> checked <%}%> >Yes</label>&nbsp;&nbsp; <label><input name="load_img" value="false" type="radio" <%if(rule.load_img === 'false'){%> checked <%}%>>No</label> 
        </td>               
      </tr> 

      <tr>
        <th>Drill rules</th>
        <td>
        <div id="ruleEditor" class="json-editor"></div>
         <div id="ruleJson">
          <textarea id="drill_rules" name="drill_rules" cols="130" rows="5"><%=rule.drill_rules%></textarea>
        </div>
        </td>      
      </tr> 
      <tr>
        <th>Drill relation</th>
        <td>
        <div id="ruleRelationEditor" class="json-editor"></div>
         <div id="ruleRelationJson">
          <textarea id="drill_relation" name="drill_relation" cols="130" rows="5"><%=rule.drill_relation%></textarea>
        </div>
        </td>      
      </tr>
      <tr>
          <th>Content validation keywords</th>
          <td><input name="validation_keywords" id="validation_keywords" value="<%=rule.validation_keywords %>" size="150" type="text"></td>
      </tr>
      <tr>
        <th>script</th>
        <td>
        <div id="scriptEditor" class="json-editor"></div>
         <div id="scriptJsonDiv">
          <textarea id="script" name="script" cols="130" rows="5"><%=rule.script%></textarea>
        </div>
        </td>      
      </tr> 

      <tr>
        <th>navigate rule</th>
        <td>
        <div id="naviEditor" class="json-editor"></div>
         <div id="naviJson">
          <textarea id="navigate_rule" name="navigate_rule" cols="130" rows="5"><%=rule.navigate_rule%></textarea>
        </div>
        </td>      
      </tr> 
      <tr>
        <th>stop page</th>
        <td> <input name="stoppage" id="stoppage" value="<%=rule.stoppage%>" size="30" type="text"></td>
      </tr> 
      <tr>
        <th>priority</th>
        <td> <input name="priority" id="priority" value="<%=rule.priority%>" size="30" type="text"></td> 
      </tr>  
      <tr>
        <th>weight</th>
        <td> <input name="weight" id="weight" value="<%=rule.weight%>" size="30" type="text"></td>
      </tr>  
      <tr>
        <th>schedule interval </th>
        <td> <input name="schedule_interval" id="schedule_interval" value="<%=rule.schedule_interval%>" size="30" type="text"></td>
      </tr>  
      <tr>
        <th>active</th>
        <td> <label><input name="active" value="true" type="radio" <%if(rule.active === 'true'){%> checked <%}%> >Yes</label>&nbsp;&nbsp; <label><input name="active" value="false" type="radio" <%if(rule.active === 'false'){%> checked <%}%>>No</label> </td>  
      </tr>  
	  <tr>
        <th>seed</th>
        <td> 
        <div id="seedEditor" class="json-editor"></div>
         <div id="seedJson">
          <textarea id="seed" name="seed" cols="130" rows="5"><%=rule.seed%></textarea>
        </div>
      </tr> 
      <tr>
        <th>schedule rule</th>
        <td>
        <label><input name="schedule_rule" value="FIFO" type="radio" <%if(rule.schedule_rule === 'FIFO'){%> checked <%}%> >FIFO</label>&nbsp;&nbsp; <label><input name="schedule_rule" value="LIFO" type="radio" <%if(rule.schedule_rule === 'LIFO'){%> checked <%}%>>LIFO</label>
        </td>
      </tr>
    </tbody>
  </table>
<input type="hidden" value="put" name="_method" />
<br>
<input type="submit" name="submit" id="submit" value="Submit"/>
<input type="reset" name="reset" id="reset" value="Reset"/>  
</form>
<br>
<br>
<br>
</body></html>